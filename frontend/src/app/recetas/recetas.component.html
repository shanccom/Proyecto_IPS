<div class="flex justify-end items-center mb-6 mt-7 ml-[80px]">
  <button class="bg-[#A7DCFF] text-black px-4 py-2 rounded-lg shadow hover:bg-[#79A5C3] transition" (click)="abrirFormulario()">
    + Agregar Receta
  </button>
</div>

<!-- Modal (Formulario) -->
<div *ngIf="mostrarFormulario" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-[#292C2D] rounded-xl shadow-lg p-6 w-full max-w-2xl max-h-full overflow-auto">
    <h3 class="text-xl font-bold text-white font-medium mb-4">Agregar Receta</h3>
    <hr class="border-t-2 border-[#5E5E5E] my-4">

    <!-- Aquí se carga el formulario de receta -->
    <app-formulario-receta 
      *ngIf="mostrarFormulario" 
      (cerrar)="cerrarFormulario()" 
      (recetaGuardada)="obtenerRecetas()">
    </app-formulario-receta>
  </div>
</div>

<!-- Tabla de Recetas -->
<div class="overflow-x-auto ml-[80px]">
  <table class="w-full text-sm text-white rounded shadow-lg  divide-y divide-[#6B6B6B] ">
    <thead class="bg-[#292C2D]">
      <!-- Fila de agrupación -->
      <tr class=" text-white text-left font-normal">
        <th rowspan="2" class="px-4 py-2 text-left text-sm font-normal text-white-700 ">Código</th>
        <th rowspan="2" class="px-4 py-2 text-left text-sm font-normal text-white-700">Fecha</th>
        <th rowspan="2" class="px-4 py-2 text-left text-sm font-normal text-white-700">Medición Propia</th>
        
        <!-- Ojo Derecho (colspan de 3 columnas) -->
        <th colspan="3" class="px-4 py-2 text-center text-sm font-normal text-white-700 border-b border-gray-600">Ojo Derecho</th>
        
        <!-- Ojo Izquierdo -->
        <th colspan="3" class="px-4 py-2 text-center text-sm font-normal text-white-700 border-b border-gray-600">Ojo Izquierdo</th>

        <!-- DIP y Adiciones -->
        <th rowspan="2" class="px-4 py-2 text-left text-sm font-normal text-white-700">DIP</th>
        <th rowspan="2" class="px-4 py-2 text-left text-sm font-normal text-white-700">OD Adición</th>
        <th rowspan="2" class="px-4 py-2 text-left text-sm font-normal text-white-700">OI Adición</th>

        <th rowspan="2" class="px-4 py-2 text-left text-sm font-normal text-white-700">Acciones</th>
      </tr>

      <!-- Fila de campos individuales -->
      <tr class=" text-white text-left font-normal">
        <th class="px-4 py-2 text-left text-sm font-normal text-white-700">SPH</th>
        <th class="px-4 py-2 text-left text-sm font-normal text-white-700">CYL</th>
        <th class="px-4 py-2 text-left text-sm font-normal text-white-700">Eje</th>

        <th class="px-4 py-2 text-left text-sm font-normal text-white-700">SPH</th>
        <th class="px-4 py-2 text-left text-sm font-normal text-white-700">CYL</th>
        <th class="px-4 py-2 text-left text-sm font-normal text-white-700">Eje</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let receta of recetas" class="hover:bg-[#3A3A3A] transition">
        <td class="px-4 py-2 border-b border-gray-600">{{ receta.codigo }}</td>
        <td class="px-4 py-2 border-b border-gray-600">{{ receta.fecha }}</td>
        <td class="px-4 py-2 border-b border-gray-600">{{ receta.medicion_propia ? 'Sí' : 'No' }}</td>

        <td class="px-4 py-2 border-b border-gray-600">{{ receta.OD_SPH }}</td>
        <td class="px-4 py-2 border-b border-gray-600">{{ receta.OD_CYL }}</td>
        <td class="px-4 py-2 border-b border-gray-600">{{ receta.OD_eje }}</td>

        <td class="px-4 py-2 border-b border-gray-600">{{ receta.OI_SPH }}</td>
        <td class="px-4 py-2 border-b border-gray-600">{{ receta.OI_CYL }}</td>
        <td class="px-4 py-2 border-b border-gray-600">{{ receta.OI_eje }}</td>

        <td class="px-4 py-2 border-b border-gray-600">{{ receta.DIP }}</td>
        <td class="px-4 py-2 border-b border-gray-600">{{ receta.OD_adicion || '-' }}</td>
        <td class="px-4 py-2 border-b border-gray-600">{{ receta.OI_adicion || '-' }}</td>

        <td class="px-4 py-2 border-b border-gray-600">
          <button class="bg-[#A7DCFF] text-black px-3 py-1 rounded hover:brightness-90 font-medium">Editar</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
